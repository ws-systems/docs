<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configure Vault | WhiteStar Docs</title>
    <meta name="description" content="WhiteStar Systems Documentation Hub">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#242524">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#242524">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    
    <link rel="preload" href="/assets/css/0.styles.0b27800c.css" as="style"><link rel="preload" href="/assets/js/app.c18db28f.js" as="script"><link rel="preload" href="/assets/js/4.96c09ab7.js" as="script"><link rel="prefetch" href="/assets/js/vendors~docsearch.38da8c88.js"><link rel="prefetch" href="/assets/js/2.2f2ca03f.js"><link rel="prefetch" href="/assets/js/3.5e4f86a3.js"><link rel="prefetch" href="/assets/js/5.f50bc2e6.js"><link rel="prefetch" href="/assets/js/6.5bcc353b.js"><link rel="prefetch" href="/assets/js/7.2b919a9f.js"><link rel="prefetch" href="/assets/js/8.640048b7.js"><link rel="prefetch" href="/assets/js/9.0d411578.js"><link rel="prefetch" href="/assets/js/10.6d4a60ef.js"><link rel="prefetch" href="/assets/js/11.097f3d10.js"><link rel="prefetch" href="/assets/js/12.db6dd5c4.js"><link rel="prefetch" href="/assets/js/13.4c4cede9.js"><link rel="prefetch" href="/assets/js/14.90430a7f.js"><link rel="prefetch" href="/assets/js/15.a46c6d49.js"><link rel="prefetch" href="/assets/js/16.172dfb99.js"><link rel="prefetch" href="/assets/js/17.00d0ef73.js"><link rel="prefetch" href="/assets/js/18.ab96eace.js"><link rel="prefetch" href="/assets/js/19.1ecfe105.js"><link rel="prefetch" href="/assets/js/20.7042e358.js"><link rel="prefetch" href="/assets/js/21.c4c20bbb.js"><link rel="prefetch" href="/assets/js/22.f8ca9bee.js"><link rel="prefetch" href="/assets/js/23.0d7fc4cd.js"><link rel="prefetch" href="/assets/js/24.e94f008a.js"><link rel="prefetch" href="/assets/js/25.18b05fe9.js"><link rel="prefetch" href="/assets/js/26.45dffb7c.js"><link rel="prefetch" href="/assets/js/27.76157cc2.js"><link rel="prefetch" href="/assets/js/28.8eced29e.js"><link rel="prefetch" href="/assets/js/29.8132e514.js"><link rel="prefetch" href="/assets/js/30.0c54d55d.js"><link rel="prefetch" href="/assets/js/31.a06ed874.js"><link rel="prefetch" href="/assets/js/32.221fc3c1.js"><link rel="prefetch" href="/assets/js/33.f5cafdd7.js"><link rel="prefetch" href="/assets/js/34.d3be44d3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b27800c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      WhiteStar Docs
    </span></a><div class="links"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Docs Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Products</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/welcome/" class="nav-link">Welcome</a></li><li class="dropdown-item"><!----><a href="/ms-mon/" class="nav-link">Mediasite Recorder Monitor</a></li><li class="dropdown-item"><!----><a href="/inventory/" class="nav-link">Inventory</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Tools</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/hub/" class="nav-link">Hub</a></li><li class="dropdown-item"><!----><a href="/vault/" class="nav-link router-link-active">Vault</a></li></ul></div></div><a href="https://github.com/ws-systems/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Docs Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Products</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/welcome/" class="nav-link">Welcome</a></li><li class="dropdown-item"><!----><a href="/ms-mon/" class="nav-link">Mediasite Recorder Monitor</a></li><li class="dropdown-item"><!----><a href="/inventory/" class="nav-link">Inventory</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Tools</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/hub/" class="nav-link">Hub</a></li><li class="dropdown-item"><!----><a href="/vault/" class="nav-link router-link-active">Vault</a></li></ul></div></div><a href="https://github.com/ws-systems/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Vault</span><!----></p><ul class="sidebar-group-items"><li><a href="/vault/" class="sidebar-link">Introduction</a></li><li><a href="/vault/installation.html" class="sidebar-link">Install Vault</a></li><li><a href="/vault/configure-vault.html" class="active sidebar-link">Configure Vault</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vault/configure-vault.html#configure-tls" class="sidebar-link">Configure TLS</a></li><li class="sidebar-sub-header"><a href="/vault/configure-vault.html#configure-users" class="sidebar-link">Configure Users</a></li><li class="sidebar-sub-header"><a href="/vault/configure-vault.html#configure-apps" class="sidebar-link">Configure Apps</a></li><li class="sidebar-sub-header"><a href="/vault/configure-vault.html#provisioning-automation" class="sidebar-link">Provisioning Automation</a></li></ul></li><li><a href="/vault/access_control.html" class="sidebar-link">Access Control</a></li><li><a href="/vault/adding-a-ui.html" class="sidebar-link">Adding a User Interface</a></li><li><a href="/vault/additional_resources.html" class="sidebar-link">Additional Resources</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="configure-vault"><a href="#configure-vault" aria-hidden="true" class="header-anchor">#</a> Configure Vault</h1><h2 id="configure-tls"><a href="#configure-tls" aria-hidden="true" class="header-anchor">#</a> Configure TLS</h2><p>By default, TLS (HTTPS) is disabled for simplicity; however, if we want to ensure the security of our secrets when we access them via the API, we want to encrypt the traffic between our API Client and the Vault Server. You can either use a Certificate/Key set that you already have provisioned for your machine, provided that you use the servers FQDN in your <code>VAULT_ADDR</code> environment variable. You may need to add the Root CA to your machine's trusted CA list, which will vary by OS. If you would like to generate your own CA and Certificate/Key pair, Sam Dunne has a great tutorial: <a href="http://dunne.io/vault-and-self-signed-ssl-certificates" target="_blank" rel="noopener noreferrer">http://dunne.io/vault-and-self-signed-ssl-certificates<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p>In the end, your TCP listener should look something like the following, with the paths and file names adjusted for your specific <code>crt</code> and <code>key</code>. If you are comfortable at this point, you can expose your server publicly, by replacing <code>127.0.0.1</code> with your public IP. <em>Note, that you will not be able to access the server via localhost, unless you have re-configured your hosts file.</em></p><div class="language- extra-class"><pre class="language-text"><code>listener &quot;tcp&quot; {
 address = &quot;127.0.0.1:8200&quot;
 tls_cert_file= &quot;/etc/vault/ssl/vault.crt&quot;,
 tls_key_file=&quot;/etc/vault/ssl/vault.key&quot;
}
</code></pre></div><h2 id="configure-users"><a href="#configure-users" aria-hidden="true" class="header-anchor">#</a> Configure Users</h2><p>Using tokens is annoying, would it not be simpler to use a username/password combination? Conveniently, Vault supports this feature nativity. To enable, run <code>vault auth-enable userpass</code> on your unsealed vault. You can then create new users via the following command, with the respective <a href="/vault/access_control.html">Access Policy</a>:</p><div class="language- extra-class"><pre class="language-text"><code>vault write auth/userpass/users/username \
    password=password \
    policies=access_level

</code></pre></div><p>To login, use the following command, be sure to substitute in your username in the command.</p><div class="language- extra-class"><pre class="language-text"><code>vault auth -method=userpass username=username
</code></pre></div><p>To change your password, use the following command, subsituting in your username and desired new password.</p><div class="language- extra-class"><pre class="language-text"><code>vault write auth/userpass/users/username password=password
</code></pre></div><h2 id="configure-apps"><a href="#configure-apps" aria-hidden="true" class="header-anchor">#</a> Configure Apps</h2><p>First, we will need to enable &quot;AppRoles&quot; which will allow our apps to authenticate themselves with the Vault. To do this we run <code>vault auth-enable approle</code>. Now, we will create as many &quot;AppRoles&quot; as we need. Use the line below as a staring point for your AppRole Creation command:</p><div class="language- extra-class"><pre class="language-text"><code>vault write auth/approle/role/role-name policies=app token_ttl=1200
</code></pre></div><p>This will create the role, to get the role-id, enter the following command with the <code>role-name</code> from the above statement:</p><div class="language- extra-class"><pre class="language-text"><code>vault read auth/approle/role/role-name/role-id
</code></pre></div><p>We will be using AppRoles in Push mode to simplify the API process, which requires us to have the server set the Secret-id ahead of time. Use the following command to do this:</p><div class="language- extra-class"><pre class="language-text"><code>vault write -f auth/approle/role/role-name/secret-id
</code></pre></div><p>Make note of both the role-id and the secret-id as both will be needed by the app to request an access token with the previously mentioned policy.</p><h2 id="provisioning-automation"><a href="#provisioning-automation" aria-hidden="true" class="header-anchor">#</a> Provisioning Automation</h2><p>If you want to speed up this process, you can use a shell script, which can be found on <a href="https://bitbucket.org/snippets/sdsu-its/yyrE5" target="_blank" rel="noopener noreferrer">BitBucket<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, which takes the app name and ACL Policy as command line arguments and prints out the role and secret ID.</p></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/ws-systems/docs/edit/master/vault/configure-vault.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="last-updated"><span class="prefix">Updated: </span><span class="time">6/21/2018, 1:02:38 AM</span></div></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/vault/installation.html" class="prev">
          Install Vault
        </a></span><span class="next"><a href="/vault/access_control.html">
          Access Control
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/4.96c09ab7.js" defer></script><script src="/assets/js/app.c18db28f.js" defer></script>
  </body>
</html>
