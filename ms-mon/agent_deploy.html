<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploying an Agent | WhiteStar Docs</title>
    <meta name="description" content="WhiteStar Systems Documentation Hub">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#242524">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#242524">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    
    <link rel="preload" href="/assets/css/0.styles.0b27800c.css" as="style"><link rel="preload" href="/assets/js/app.3eeba378.js" as="script"><link rel="preload" href="/assets/js/14.fcf2ef41.js" as="script"><link rel="prefetch" href="/assets/js/vendors~docsearch.b06c41e8.js"><link rel="prefetch" href="/assets/js/2.5743ba00.js"><link rel="prefetch" href="/assets/js/3.86a03c52.js"><link rel="prefetch" href="/assets/js/4.eacab91c.js"><link rel="prefetch" href="/assets/js/5.59bc4b8f.js"><link rel="prefetch" href="/assets/js/6.a57942ae.js"><link rel="prefetch" href="/assets/js/7.b22bf3d5.js"><link rel="prefetch" href="/assets/js/8.6e8adcf7.js"><link rel="prefetch" href="/assets/js/9.cf6f647a.js"><link rel="prefetch" href="/assets/js/10.ce82a879.js"><link rel="prefetch" href="/assets/js/11.7dac26f9.js"><link rel="prefetch" href="/assets/js/12.57d600c8.js"><link rel="prefetch" href="/assets/js/13.0e3e5331.js"><link rel="prefetch" href="/assets/js/15.0e7630c4.js"><link rel="prefetch" href="/assets/js/16.8cb0b4bd.js"><link rel="prefetch" href="/assets/js/17.a23973e6.js"><link rel="prefetch" href="/assets/js/18.62d43172.js"><link rel="prefetch" href="/assets/js/19.9dbd42f7.js"><link rel="prefetch" href="/assets/js/20.c78a5d9e.js"><link rel="prefetch" href="/assets/js/21.4e1979e6.js"><link rel="prefetch" href="/assets/js/22.b7551c99.js"><link rel="prefetch" href="/assets/js/23.0c45bf76.js"><link rel="prefetch" href="/assets/js/24.0cb3cb14.js"><link rel="prefetch" href="/assets/js/25.eedf0cfc.js"><link rel="prefetch" href="/assets/js/26.94de5962.js"><link rel="prefetch" href="/assets/js/27.b4ed9210.js"><link rel="prefetch" href="/assets/js/28.b712f732.js"><link rel="prefetch" href="/assets/js/29.ed87fc0e.js"><link rel="prefetch" href="/assets/js/30.ad78d3fb.js"><link rel="prefetch" href="/assets/js/31.1c28754c.js"><link rel="prefetch" href="/assets/js/32.e2c0cf46.js"><link rel="prefetch" href="/assets/js/33.f5cafdd7.js"><link rel="prefetch" href="/assets/js/34.044cf0e7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b27800c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      WhiteStar Docs
    </span></a><div class="links"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Docs Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Products</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/welcome/" class="nav-link">Welcome</a></li><li class="dropdown-item"><!----><a href="/ms-mon/" class="nav-link router-link-active">Mediasite Recorder Monitor</a></li><li class="dropdown-item"><!----><a href="/inventory/" class="nav-link">Inventory</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Tools</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/hub/" class="nav-link">Hub</a></li><li class="dropdown-item"><!----><a href="/vault/" class="nav-link">Vault</a></li></ul></div></div><a href="https://github.com/ws-systems/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Docs Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Products</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/welcome/" class="nav-link">Welcome</a></li><li class="dropdown-item"><!----><a href="/ms-mon/" class="nav-link router-link-active">Mediasite Recorder Monitor</a></li><li class="dropdown-item"><!----><a href="/inventory/" class="nav-link">Inventory</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Tools</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/hub/" class="nav-link">Hub</a></li><li class="dropdown-item"><!----><a href="/vault/" class="nav-link">Vault</a></li></ul></div></div><a href="https://github.com/ws-systems/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Mediasite Recorder Monitor</span><!----></p><ul class="sidebar-group-items"><li><a href="/ms-mon/" class="sidebar-link">MediaSite Recorder Monitor</a></li><li><a href="/ms-mon/web_install.html" class="sidebar-link">Web Server Installation</a></li><li><a href="/ms-mon/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/ms-mon/agent_deploy.html" class="active sidebar-link">Deploying an Agent</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ms-mon/agent_deploy.html#create-the-container" class="sidebar-link">Create the Container</a></li><li class="sidebar-sub-header"><a href="/ms-mon/agent_deploy.html#authorizing-the-agent" class="sidebar-link">Authorizing the Agent</a></li><li class="sidebar-sub-header"><a href="/ms-mon/agent_deploy.html#updating-the-agent" class="sidebar-link">Updating the Agent</a></li></ul></li><li><a href="/ms-mon/user_management.html" class="sidebar-link">Managing Users</a></li><li><a href="/ms-mon/usage.html" class="sidebar-link">Day-to-day Usage</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="deploying-an-agent"><a href="#deploying-an-agent" aria-hidden="true" class="header-anchor">#</a> Deploying an Agent</h1><p>Agents are the workers for the Recorder Monitor. Agents allow the server component to be deployed outside of the network to which the recorders are connected to. This is especially useful in corporate or educational networks were security is key. If your web server will be running on the same network as the recorders, the directions below still apply, but you can deploy both the server image and the agent image to the same Docker host.</p><p>The latest version of the Agent image is available in the <a href="https://hub.docker.com/r/wssystems/mms-agent/" target="_blank" rel="noopener noreferrer">Docker Hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, and is updated whenever a new version of Mediasite Recorder Monitor is released. It is important that the versions of the Agent and the Server match up to avoid incompatibilities and strange behaviors.</p><h2 id="create-the-container"><a href="#create-the-container" aria-hidden="true" class="header-anchor">#</a> Create the Container</h2><p>You will first need to make sure that Docker (Community Edition is more than sufficient) is running on the host you want to deploy the agent to. Instructions on how to do this can be found on <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">Docker's Website<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p><p>The agent authenticates with the server using a unique ID that is generated on first run, this is then saved to allow the agent to be authenticated, even after container restarts. While it is not required to setup the volume mapping for the container, it is recommended to reduce downtime.</p><p>You will need to set the <code>MS_MON_SERVER_URL</code> to the URL of the Mediasite Recorder Monitor Server this agent will report to. The <code>MS_MON_AGENT_NAME</code> does not need to be unique and is used to identify the agent to users in the Web Admin Panel from within the Monitor.</p><div class="language-bash extra-class"><pre class="language-bash"><code>docker create --name mms-agent \
  -e MS_MON_SERVER_URL<span class="token operator">=</span><span class="token string">&quot;&lt;MMS Server URL&gt;&quot;</span> \
  -e MS_MON_AGENT_NAME<span class="token operator">=</span><span class="token string">&quot;&lt;Display Name Agent&gt;&quot;</span>
  -v <span class="token operator">&lt;</span>local config path<span class="token operator">&gt;</span>:/var/lib/ms-mon-agent/config.properties \
  --restart<span class="token operator">=</span>always \
  wssystems/mms-agent

docker start mms-agent  
</code></pre></div><h2 id="authorizing-the-agent"><a href="#authorizing-the-agent" aria-hidden="true" class="header-anchor">#</a> Authorizing the Agent</h2><p>Once the agent has started up and gone through its initialization, it will register with the Server. You will need to authorize the agent before it can access your credentials and start working on queued jobs. This is to prevent unauthorized agents from gaining access to your configuration and causing issues in the Job Queue.</p><p>From the Monitor Web interface, access the Agents panel from <strong>Manage &gt; Agents</strong>. There you will see a listing of all the agents.
<img src="/assets/img/manage_agents.c7795a2c.png" alt="Agent Listing"></p><p>To authorize the agent, click on the &quot;Edit&quot; button, then check the &quot;Authorize Agent&quot; checkbox, and then &quot;Update Agent.&quot; Within 30 seconds, the agent will pull the configuration from the server and start working jobs that are in the queue (if there are any).
<img src="/assets/img/update_agent.86cbd3f7.png" alt="Edit Dialog"></p><h2 id="updating-the-agent"><a href="#updating-the-agent" aria-hidden="true" class="header-anchor">#</a> Updating the Agent</h2><p>When you update the Recorder Monitor Server, you may need to update the agent as well (this will typically be specified in the release/commit notes). To do so, you will need to stop and delete the existing agent container, then pull and start the new version.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>You will want to make sure the job queue is empty when you stop the agent, else the job in progress might be delayed. If you need to update the agent while there are jobs queued, you can reauthorize the agent, wait about 5 minutes for the currently executing job to finish, then stop the agent.</p></div><div class="language-bash extra-class"><pre class="language-bash"><code>docker stop mms-agent
docker <span class="token function">rm</span> -v mms-agent

docker pull wssystems/mms-agent

docker create --name mms-agent \
  -e MS_MON_SERVER_URL<span class="token operator">=</span><span class="token string">&quot;&lt;MMS Server URL&gt;&quot;</span> \
  -e MS_MON_AGENT_NAME<span class="token operator">=</span><span class="token string">&quot;&lt;Display Name Agent&gt;&quot;</span>
  -v <span class="token operator">&lt;</span>local config path<span class="token operator">&gt;</span>:/var/lib/ms-mon-agent/config.properties \
  --restart<span class="token operator">=</span>always \
  wssystems/mms-agent

docker start mms-agent  
</code></pre></div><p>Because of the volume mapping, you will not need to reauthorize the agent.</p></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/ws-systems/docs/edit/master/ms-mon/agent_deploy.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="last-updated"><span class="prefix">Updated: </span><span class="time">7/14/2018, 11:20:10 PM</span></div></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/ms-mon/configuration.html" class="prev">
          Configuration
        </a></span><span class="next"><a href="/ms-mon/user_management.html">
          Managing Users
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/14.fcf2ef41.js" defer></script><script src="/assets/js/app.3eeba378.js" defer></script>
  </body>
</html>
